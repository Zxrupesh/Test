-- Simple War Machines UI
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local ToggleButton = Instance.new("TextButton")
local Status = Instance.new("TextLabel")
local CooldownToggle = Instance.new("TextButton")
local ReturnToggle = Instance.new("TextButton")

-- Create UI
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.5, -100, 0.5, -100)
Frame.Size = UDim2.new(0, 200, 0, 200)
Frame.Draggable = true

Title.Parent = Frame
Title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Title.BorderSizePixel = 0
Title.Size = UDim2.new(0, 200, 0, 30)
Title.Font = Enum.Font.SourceSansBold
Title.Text = "War Machines Exploit"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14

ToggleButton.Parent = Frame
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleButton.BorderSizePixel = 0
ToggleButton.Position = UDim2.new(0, 20, 0, 50)
ToggleButton.Size = UDim2.new(0, 160, 0, 30)
ToggleButton.Font = Enum.Font.SourceSans
ToggleButton.Text = "Start Script"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 14

Status.Parent = Frame
Status.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Status.BorderSizePixel = 0
Status.Position = UDim2.new(0, 20, 0, 90)
Status.Size = UDim2.new(0, 160, 0, 20)
Status.Font = Enum.Font.SourceSans
Status.Text = "Status: Stopped"
Status.TextColor3 = Color3.fromRGB(255, 255, 255)
Status.TextSize = 14

CooldownToggle.Parent = Frame
CooldownToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
CooldownToggle.BorderSizePixel = 0
CooldownToggle.Position = UDim2.new(0, 20, 0, 120)
CooldownToggle.Size = UDim2.new(0, 160, 0, 25)
CooldownToggle.Font = Enum.Font.SourceSans
CooldownToggle.Text = "Auto Cooldown: ON"
CooldownToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
CooldownToggle.TextSize = 14

ReturnToggle.Parent = Frame
ReturnToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ReturnToggle.BorderSizePixel = 0
ReturnToggle.Position = UDim2.new(0, 20, 0, 150)
ReturnToggle.Size = UDim2.new(0, 160, 0, 25)
ReturnToggle.Font = Enum.Font.SourceSans
ReturnToggle.Text = "Return Movement: OFF"
ReturnToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
ReturnToggle.TextSize = 14

-- Initialize variables
getgenv().WarMachinesExecuted = getgenv().WarMachinesExecuted or false
getgenv().AutoCooldown = getgenv().AutoCooldown or true
getgenv().Return = getgenv().Return or false

-- Update button states
if getgenv().WarMachinesExecuted then
    ToggleButton.Text = "Stop Script"
    Status.Text = "Status: Running"
else
    ToggleButton.Text = "Start Script"
    Status.Text = "Status: Stopped"
end

if getgenv().AutoCooldown then
    CooldownToggle.Text = "Auto Cooldown: ON"
else
    CooldownToggle.Text = "Auto Cooldown: OFF"
end

if getgenv().Return then
    ReturnToggle.Text = "Return Movement: ON"
else
    ReturnToggle.Text = "Return Movement: OFF"
end

-- Button functions
ToggleButton.MouseButton1Click:Connect(function()
    getgenv().WarMachinesExecuted = not getgenv().WarMachinesExecuted
    
    if getgenv().WarMachinesExecuted then
        ToggleButton.Text = "Stop Script"
        Status.Text = "Status: Running"
        
        -- Run the exploit
        spawn(function()
            local plr = game.Players.LocalPlayer
            if not plr.Character or not plr.Character:FindFirstChild("HumanoidRootPart") then return end
            
            -- Teleport to start position
            plr.Character.HumanoidRootPart.CFrame = CFrame.new(500, 700, 265)
            wait(0.1)
            
            -- Create velocity object
            if not getgenv().PlrVelocity then
                getgenv().PlrVelocity = Instance.new("BodyVelocity")
                getgenv().PlrVelocity.Parent = plr.Character:FindFirstChild("LowerTorso") or plr.Character.HumanoidRootPart
                getgenv().PlrVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                getgenv().PlrVelocity.Velocity = Vector3.new(0, 0, 0)
            end
            
            local Loops = 0
            local Direction = 1
            
            while getgenv().WarMachinesExecuted and plr.Character do
                if not plr.Character:FindFirstChild("HumanoidRootPart") then break end
                
                Loops = Loops + 1
                
                if Loops == 40 and getgenv().Return then
                    Direction = Direction * -1
                    Loops = 0
                end
                
                if getgenv().PlrVelocity then
                    getgenv().PlrVelocity.Velocity = Vector3.new(0, 1250 * Direction, 0)
                end
                
                wait(0.5)
                
                if getgenv().PlrVelocity then
                    getgenv().PlrVelocity.Velocity = Vector3.new(0, 100, 0)
                end
                
                -- Overheat handling
                if getgenv().AutoCooldown and plr.Character:GetAttribute("Overheat") and plr.Character:GetAttribute("Overheat") >= 900 then
                    repeat
                        if plr.Character:FindFirstChild("HumanoidRootPart") then
                            plr.Character.HumanoidRootPart.CFrame = CFrame.new(-830.82, 285, -509.22)
                        end
                        wait(0.1)
                    until not getgenv().WarMachinesExecuted or not plr.Character or not plr.Character:GetAttribute("Overheat") or plr.Character:GetAttribute("Overheat") <= 50
                end
                
                -- Simulate jumps
                pcall(function()
                    game:GetService('VirtualInputManager'):SendKeyEvent(true, Enum.KeyCode.Space, false, game)
                    wait(0.1)
                    game:GetService('VirtualInputManager'):SendKeyEvent(false, Enum.KeyCode.Space, false, game)
                end)
            end
        end)
    else
        ToggleButton.Text = "Start Script"
        Status.Text = "Status: Stopped"
        
        -- Stop the exploit
        local plr = game.Players.LocalPlayer
        if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and getgenv().PlrVelocity then
            getgenv().PlrVelocity.Velocity = Vector3.new(0, 0, 0)
            wait(0.1)
            getgenv().PlrVelocity:Destroy()
        end
    end
end)

CooldownToggle.MouseButton1Click:Connect(function()
    getgenv().AutoCooldown = not getgenv().AutoCooldown
    if getgenv().AutoCooldown then
        CooldownToggle.Text = "Auto Cooldown: ON"
    else
        CooldownToggle.Text = "Auto Cooldown: OFF"
    end
end)

ReturnToggle.MouseButton1Click:Connect(function()
    getgenv().Return = not getgenv().Return
    if getgenv().Return then
        ReturnToggle.Text = "Return Movement: ON"
    else
        ReturnToggle.Text = "Return Movement: OFF"
    end
end)
